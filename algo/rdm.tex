\documentclass[aps,12pt]{revtex4}
\usepackage[a4paper]{geometry}
\usepackage{graphicx}
\usepackage{amssymb,amsfonts,amsmath,amsthm}
\usepackage{bm}
\usepackage{pslatex}
\usepackage{chemarr}
\usepackage{mathptmx}
\usepackage{bookman}
\usepackage{esint}
\usepackage{xfrac}  	 
	 
\newcommand{\half}{\frac{1}{2}}
	 
\begin{document}

\title{Asymptotic Reaction Diffusion Migration}
\maketitle

\section{Reaction(s)}

\subsection{Notations}
Let's assume that we have $N$ equilibria coupling $M$ species.
We define $a_j$ the activity of species $A_j$, and $\nu_{ij}$ the algebraic
coefficient of $A_j$ in the $i-$th equilibria $E_i$:
\begin{equation}
	E_i : \sum_j \nu_{ij} A_j = 0, \;\;K_i = \prod_j a_j^{\nu_{ij}}
\end{equation}
We remove the singularities by defining:
\begin{equation}
	\Xi_i(\vec C) = \underbrace{(K_i \prod_{j,\nu_{ij}<0} a_j^{-\nu_{ij}})}_{reactant(s)} - \underbrace{\prod_{j,\nu_{ij}\geq0} a_j^{\nu_{ij}}}_{product(s)}
\end{equation}
and we define an equilibrium state by:
\begin{equation}
	\vec \Xi ( \vec C ) = \vec 0
\end{equation}

\subsection{Perturbation}
Let us make an external "slow" perturbation 
\begin{equation}
	\vec \sigma \, \mathrm{d} t \in \mathbb R ^M
\end{equation}
Then the system will respond with:
\begin{equation}
	\mathrm{d} \vec C = \bm{\nu}^T \, \mathrm{d}\vec \xi\; (\bm{\nu} \in \mathcal M_{N,M},\;\; \vec \xi \in \mathbb R ^N)
\end{equation}
such that
\begin{equation}
	\vec \Xi(\vec C + \vec \sigma \, \mathrm{d} t + \mathrm{d} \vec C ) = \vec 0 \iff \vec 0 = 
	\bm{\Phi} \times ( \vec \sigma \, \mathrm{d} t + \bm{\nu}^T \, \mathrm{d}\vec \xi)
\end{equation}

\begin{equation}
	\bm{\Phi} = \partial_{\vec C} \vec \Xi \in \mathcal M_{N,M}
\end{equation}
so that, starting from $\vec \Xi ( \vec C ) = \vec 0$, the system evolves locally according to:
\begin{equation}
\boxed{
	\partial_t \vec C = \left[\bm{I}_M - \bm{\nu}^T (\bm \Phi \bm{\nu}^T) ^{-1} \bm \Phi \right] \vec \sigma
	}
\end{equation}
which conserves the charge for valid equilibrium(a).

\subsection{Single Root}

For a running (non-blocked) equilibrium:
\begin{equation}
	\Xi_i(\vec C_0 + \xi_{i}^\star \vec \nu_i ) = 0
\end{equation}

\begin{equation}
	\Xi_i(\vec C_0 + \delta \vec C + (\xi_i^\star + \delta  \xi_i^\star)\vec \nu_i  ) = 0
	\implies
	\langle \vec \Phi_i^\star \vert \delta \vec C +  \delta \xi_i^\star \vec \nu_i \rangle = 0
\end{equation}

\begin{equation}
	 \delta \xi_i^\star = - \dfrac{\langle \vec \Phi_i^\star \vert \delta \vec C \rangle }
	 { \langle \vec \Phi_i^\star \vert \vec \nu_i \rangle  }
	 =
	  - \dfrac{\langle \vec \Phi_i^\star \vert \bm{\nu}^T \vert \delta \vec \xi \rangle }
	 { \langle \vec \Phi_i^\star \vert \vec \nu_i \rangle  }
\end{equation}

\begin{equation}
	\delta \vec \xi_i ^\star = - \bm\Upsilon \delta \vec \xi
\end{equation}

\begin{equation}
	\bm\Upsilon_{i,j} = 
	\left\lbrace
	\begin{array}{rl}
	1 & \text{if } i=j\\
	\dfrac{\langle \vec \Phi_i^\star \vert \vec \nu_j \rangle }{\langle \vec \Phi_i^\star \vert \vec \nu_i \rangle } & \text{if } i\not=j\\
	\end{array}
	\right.
\end{equation}
	
\begin{equation}
	\xi_i ^\circ = \xi_i^\star - \langle \vec\Upsilon_i \vert \delta \vec \xi \rangle
\end{equation}
	
How to chose $\delta \vec \xi$ so that we decrease:
\begin{equation}
	C^\circ = \sum_i \vert \xi_i^\circ \vert 
\end{equation}

\subsection{...}
We know that:
\begin{equation}
	\Xi_i(\vec C_0 + \xi_i^\star \vec \nu _i) = \Xi_i(\vec C_i^\star) = 0
\end{equation}

We want to decrease $\Xi_i$ with $\delta \vec C$.

\begin{equation}
	\Xi_i(\vec C_0 + \delta \vec C) \simeq \Xi_i(\vec C_0 + \alpha_i \vec \nu_i) + 
	\langle \vec \Phi_{\alpha_i} \vert \underbrace{\delta \vec C - \alpha_i \vec \nu_i}_{\in\vec\nu_i^\perp} \rangle
\end{equation}

\begin{equation}
	\delta \vec C = \sum_j x_j \vec \nu_j \implies 
	\alpha_i = \dfrac{1}{\vec \nu_i^2} \sum_j x_j \langle \vec \nu_j \vert \vec \nu_i \rangle
	= x_i + \dfrac{1}{\vec \nu_i^2} \sum_{j\not=i} x_j \langle \vec \nu_j \vert \vec \nu_i \rangle
\end{equation}

\begin{equation}
\delta \vec C - \alpha_i \vec\nu_i = x_i \vec\nu_i + \sum_{j\not=i} x_j \vec\nu_j - \left(  x_i + \dfrac{1}{\vec \nu_i^2} \sum_{j\not=i} x_j \langle \vec \nu_j \vert \vec \nu_i \rangle\right) \vec\nu_i
\end{equation}

\begin{equation}
\delta \vec C - \alpha_i \vec\nu_i =  \sum_{j\not=i} x_j \underbrace{\left(\vec\nu_j - \dfrac{\langle\vec \nu_j \vert \vec \nu_i \rangle}{\vec\nu_i^2} \vec\nu_i\right)}_{\in\vec\nu_i^\perp}
\end{equation}

\subsection{...}
We know that:
\begin{equation}
	\Xi_i(\vec C_0 + \xi_i^\star \vec \nu _i) = \Xi_i(\vec C_0 + \delta \vec C_i^\star) = \Xi_i(\vec C_i^\star) = 0
\end{equation}

Let us suppose that:
\begin{equation}
	\Xi_1(\vec C_0 + \delta \vec C_1^\star) = 0 \text{ and } \Xi_2(\vec C_0 + \delta \vec C_2^\star) =0 
\end{equation}

\begin{equation}
	\Xi_1(\vec C_0 + \beta_1 \delta \vec C_1^\star + \beta_2 \delta \vec C_2^\star) = 
	\Xi_1\left(\vec C_0 + (\beta_1 + \alpha_2) \vec C_1^\star + \left(\beta_2 \delta \vec C_2^\star - \alpha_2 \delta \vec C_1^\star\right) \right)
\end{equation}

\begin{equation}
	\alpha_2 = \beta_2 \dfrac{\langle \delta \vec C_2^\star \vert \delta \vec C_1^\star\rangle}{ {\delta \vec C_1^\star} ^2 }
\end{equation}

\begin{equation}
	\Xi_1(\vec C_0 + \beta_1 \delta \vec C_1^\star + \beta_2 \delta \vec C_2^\star) 
	\simeq 
\end{equation}

\subsection{Conservation}

A conservation law is a vector of {\bf positive} coefficients $\vec \alpha$ such that:
\begin{equation}
	\langle \vec \alpha \vert \vec C \rangle \geq 0
\end{equation}
is conserved during shifts in equilibria.\\
Let's assume that
\begin{equation}
	\langle \vec \alpha \vert \vec C \rangle = -X_s < 0 
\end{equation}
Then we will inject the smallest $\delta \vec C$ such that:
\begin{equation}
	\langle \vec \alpha \vert \delta \vec C \rangle = X_s
\end{equation}

\begin{equation}
	\delta \vec C = \dfrac{X_s}{\vec\alpha^2} \vec{\alpha}
\end{equation}

To preserve numeric symmetry
\begin{equation}
	\vec C_{new} = \vec C + \delta \vec C = \dfrac{1}{\vec \alpha^2}\left[\vec \alpha^2 \bm{I} - \vert \vec \alpha \rangle \langle \vec \alpha \vert \right] \vec C
\end{equation}

 	

\section{Diffusion/Migration}

\subsection{Electro Chemical potential}

\begin{equation}
	\mu_i = RT \ln a_i + z_i \mathcal{F} V = RT \ln (\gamma_i[C_i]) + z_i \mathcal{F} V
\end{equation}
where $V$ is the external electric potential and
%Poisson equation:
%\begin{equation}
%	\Delta V = - \dfrac{\rho}{\epsilon} = -\dfrac{\mathcal{F}}{\epsilon} k_1 \sum_i z_i C_i,\;k_1=1000
%\end{equation}
%We have $\rho$ in [elementary charges/$m^3$] and $C$ in moles/$dm^3$.

\begin{equation}
	\vec{E} = -\vec{\nabla} V
\end{equation}
is the external electric field.

\subsection{Particular velocity}
Molecular force:	
\begin{equation}
	\vec{F}_i = - \frac{1}{\mathcal{N}_A} \vec{\nabla} \mu_i
\end{equation}

Molecular motion:
\begin{equation}
	m_i \ddot {\vec{r}} = \vec{F}_i - a_i \vec{v}_i \implies \vec{v}_i \simeq \dfrac{1}{a_i} \vec{F}_i
\end{equation}

\begin{equation}
	\vec{v}_i = -\underbrace{\dfrac{k_bT}{a_i}}_{D_i} \vec{\nabla}(\ln(\gamma_i C_i))  + z_i \underbrace{\dfrac{ q}{a_i}}_{\lambda_i} \vec{E}
\end{equation}

\begin{equation}
	\lambda_i = \frac{q}{k_bT} D_i = \dfrac{\mathcal{F}}{RT} D_i
\end{equation}

\begin{equation}
\boxed{
	\vec{v}_i = D_i \left[ - \vec{\nabla}(\ln(\gamma_i C_i)) + z_i \dfrac{\mathcal{F}}{RT} \vec{E} \right]
}
\end{equation}

\subsection{Continuity equations}

Molar flux:
\begin{equation}
	\vec{J}_i = C_i \vec{v}_i = D_i \left[z_i C_i  \dfrac{\mathcal{F}}{RT} \vec{E} - \left(\vec{\nabla} C_i + C_i \vec{\nabla}\Gamma_i\right) \right],\;\;\Gamma_i = \ln \gamma_i
\end{equation}

Continuity equation:
\begin{equation}
	\partial_t C_i + \mathrm{div} \vec{J}_i = \sigma_i
\end{equation}
which generally doesn't conserve the charge.

We define $\vec \eta$ the local reaction field that modifies the fluxes:
\begin{equation}
	\vec \psi_i = z_i D_i C_i \vec \eta
\end{equation}

Let's find the smallest field in a conservative field.

\subsection{Three Bodies Problem}

\subsubsection{Electric coupling}
We take a linear part of length $2L$, and a control volume between $L_-=L/2$ and $L_+=3L/2$,
with boundary conditions $\vec C_0$ and $\vec C_L$.

\begin{equation}
	\dfrac{1}{V} \iiint \partial_t C_i(\vec r,t)  \mathrm{d}\, \vec r
	= - \oiint  	\vec{J}_i \mathrm{d}\, \vec S + \dfrac{1}{V} \iiint \sigma_i \mathrm{d}\, \vec r
\end{equation}
 
\begin{equation}
	\partial_t C_i = -\dfrac{S}{V}(J_{i+}-J_{i-}) + \sigma_i
\end{equation}

\begin{equation}
	J_{i\pm} = \underbrace{\hat J_{i\pm}}_{-D_{i\pm} \partial_x C_{i\pm}+\ldots} + z_i D_{i\pm} C_{i\pm} \eta_\pm
\end{equation}

\begin{equation}
	\partial_t C_i = \sigma_i -\dfrac{1}{L} \left[ \hat J_{i+}- \hat J_{i-} + z_i (D_{i+} C_{i+} \eta_+ - D_{i-}C_{i-} \eta_-) \right] 
\end{equation}
that we rewrite as:
\begin{equation}
	\partial_t C_i =
	 \underbrace{\sigma_i -\dfrac{1}{L} \left[ \hat J_{i+}- \hat J_{i-} \right]}_{F_i} 
	 - \dfrac{1}{L}  \left[ z_i (D_{i+} C_{i+} \eta_+ - D_{i-}C_{i-} \eta_-)\right] 
\end{equation}


\begin{equation}
	\sum_i z_i \partial_t C_i =  \langle \vec Z \vert \vec F \rangle - \dfrac{1}{L} \left[ \Omega_+ \eta_{+} - \Omega_- \eta_-\right]
\end{equation}

\begin{equation}
	\Omega_\pm = \sum_i z_i^2 D_{i\pm} C_{i\pm}
\end{equation}
The smallest field is 
\begin{equation}
	\eta_\pm = \pm \dfrac{L \langle \vec Z \vert \vec F \rangle \Omega\pm}{\Omega_-^2+\Omega_+^2}
\end{equation}

\begin{equation}
	\partial_t C_i = F_i - \underbrace{\dfrac{z_i}{\Omega_{i+}^2 + \Omega_{i-}^2} \left[ D_{i+} C_{i+} \Omega_+ + D_{i-} C_{i-} \Omega_- \right]}_{\omega_i} \langle \vec Z \vert \vec F \rangle
\end{equation}

We check that $\langle \vec Z \vert \vec \omega \rangle \equiv 1$.
\begin{equation}
\boxed{
	\partial_t \vec C = \left[\bm I_M - \vert\vec \omega \rangle \langle \vec Z \vert \right] \vec F
	}
\end{equation}
We now expand with the chemical part:


\subsubsection{Electrochemical Coupling}

\begin{equation}
	\partial_t \vec C = \left[\bm{I}_M - \bm{\nu}^T (\bm \Phi \bm{\nu}^T) ^{-1} \bm \Phi \right] \left[\bm I_M - \vert\vec \omega \rangle \langle \vec Z \vert \right] \vec F
\end{equation}


\subsubsection{Three Bodies Saline Solution}

We have water with $NaCl$, four components, one reaction.
We define the left and right side by their osmolarity and pH.

\begin{equation}
\left[\bm{I}_M - \bm{\nu}^T (\bm \Phi \bm{\nu}^T) ^{-1} \bm \Phi \right]
=
\begin{bmatrix}
\frac{h}{w+h} & - \frac{h}{w+h} & 0 & 0\\
-\frac{w}{w+h} & \frac{w}{w+h}  & 0 & 0\\
0 & 0 & 1 & 0\\
0 & 0 & 0 & 1\\
\end{bmatrix}
\end{equation}

\begin{equation}
\left[\bm I_M - \vert\vec \omega \rangle \langle \vec Z \vert \right] =
\begin{bmatrix}
1-\omega_h & \omega_h & -\omega_h & \omega_h\\
-\omega_w  & 1+\omega_w & -\omega_w & \omega_w\\
-\omega_{Na}  & \omega_{Na} & 1-\omega_{Na} & \omega_{Na}\\
-\omega_{Cl}  & \omega_{Cl} & -\omega_{Cl} & 1+\omega_{Cl}\\
\end{bmatrix}
\end{equation}

\section{Data}

\begin{equation}
\begin{array}{|l|r|}
\hline
 \text{} & D[m^2/s]  \\
 \hline
 	H^+	 & 9.31\cdot10^{-9}	\\
 	Na^+ & 1.33\cdot10^{-9}	 \\
 	K^+	 & 1.96\cdot10^{-9}	 \\
 	HO^- & 5.27\cdot10^{-9}	 \\
 	Cl^- & 2.03\cdot10^{-9} \\
 	Br^- & 2.01\cdot10^{-9} \\
\hline
\end{array}
\end{equation}
$$
	K_w = 10^{-14}\; M^2
$$

\section{1D}

We have 
\begin{equation}
	\dfrac{1}{V_k} \partial_t \iiint_{V_k} [A_i] \mathrm d\vec r = \dfrac{1}{V_k} \iiint_{V_k} \left[ \mathrm{div} \vec J_i + \mathrm{div} \vec \Psi _i + \sigma_i \right] \mathrm d \vec r
\end{equation}

\begin{equation}
	\partial_t [A_i]_k = \dfrac{1}{V_k}\oiint_{S_k}  \left[ \vec J_i + \vec \Psi_i \right] \cdot \mathrm d \vec S + \sigma_{i,k}
\end{equation}


\begin{equation}
	\partial_t  [A_i]_k = \dfrac{1}{L_k} \left[ \hat J_{i,k+\half} - \hat J_{i,k-\half} \right] 
	+ \dfrac{z_i}{L_k}\left[ D_{i,k+\half} C_{i,k+\half} \eta_{k+\half} -  D_{i,k-\half} C_{i,k-\half} \eta_{k-\half}\right]+ \sigma_{i,k}
\end{equation}

\begin{equation}
	F_{i,k} =  \dfrac{1}{L_k} \left[ \hat J_{i,k+\half} - \hat J_{i,k-\half} \right]  + \sigma_{i,k}
\end{equation}

\begin{equation}
	\Omega_{\square} = \sum_i z_i^2 D_{i,\square} C_{i,\square}
\end{equation}

\begin{equation}
	\sum_i z_i \partial_t [A_i]_k = 0 \iff \langle \vec Z \vert \vec F_k \rangle
	 + \dfrac{1}{L_k}\left[\Omega_{k+\half} \eta_{k+\half} - \Omega_{k-\half} \eta_{k-\half}\right]
\end{equation}

Let's say we have $n$ vertices labeled with $k\in[1:n]$, then we have $n+1$ interfaces labeled as $\dfrac{2k+1}{2},\;k\in[0:n]$.
We define
\begin{equation}
	\vec \eta \in \mathbb R ^ {n+1}
\end{equation}

\begin{equation}
	\mathcal L = \dfrac{1}{2} \vec \eta ^2 - \sum_k \lambda_k \left(\langle \vec Z \vert \vec F_k \rangle
	 + \dfrac{1}{L_k}\left[\Omega_{k+\half} \eta_{k+\half} - \Omega_{k-\half} \eta_{k-\half}\right]\right)
\end{equation}

\begin{equation}
	\mathcal L = \dfrac{1}{2} \vec \eta ^2 - \langle \vec \lambda \vert \vec{ZF} - 
	\left[\mathfrak D (\vec L)^{-1} \bm M_\nabla \mathfrak D(\vec\Omega)\right] \vec \eta \rangle
\end{equation}

\begin{equation}
	\partial_{\vec \eta} L = \vec \eta +\left[ D(\vec\Omega) \bm M_\nabla ^T D (\vec L)^{-1} \right] \vec \lambda
	\implies \vec \eta = - \left[ \mathfrak D(\vec\Omega) \bm M_\nabla ^T \mathfrak D (\vec L)^{-1} \right] \vec \lambda
\end{equation}

\begin{equation}
	0 = \vec {ZF} + \left[\mathfrak D (\vec L)^{-1} \bm M_\nabla \mathfrak D(\vec\Omega)\right] 
	\left[ \mathfrak D(\vec\Omega) \bm M_\nabla ^T \mathfrak D (\vec L)^{-1} \right] \vec \lambda
\end{equation}

\begin{equation}
	\vec \eta = - \left[ \mathfrak D(\vec\Omega) \bm M_\nabla ^T \mathfrak D (\vec L)^{-1} \right] \left( \left[\mathfrak D (\vec L)^{-1} \bm M_\nabla \mathfrak D(\vec\Omega)\right] \left[ \mathfrak D(\vec\Omega) \bm M_\nabla ^T \mathfrak D (\vec L)^{-1} \right]\right) ^{-1} \vec{ZF}
\end{equation}

\end{document}
